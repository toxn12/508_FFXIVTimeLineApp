# 基本設計書

## FF14 零式タイムライン管理ツール

| 項目 | 内容 |
|------|------|
| 作成日 | 2026-01-19 |
| ステータス | 作成中 |

---

## 1. アーキテクチャ

### 1.1 動作環境
- **ブラウザアプリ（静的HTML/JS）**
- サーバー不要
- モダンブラウザ対応（Chrome, Firefox, Edge, Safari）

### 1.2 データ構造（2層構成）

```
┌─────────────────────────────────────────────────────────────┐
│  コンテンツ（ボスタイムライン）← 共通テンプレート           │
│  ├─ レイド名（フォルダ名）                                  │
│  ├─ ボス名                                                 │
│  ├─ タイムライン長                                         │
│  ├─ フェーズ一覧                                           │
│  └─ ギミック一覧                                           │
│      → 編集モード時のみ変更可能                            │
│      → JSONファイルとしてサブフォルダに配置                │
└─────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────┐
│  パーティ構成 ← 固定パーティごとに作成                      │
│  ├─ パーティ名                                             │
│  └─ メンバー（1〜8人）                                     │
│       ├─ プレイヤー名                                      │
│       ├─ ロール（Tank/Healer/DPS）                         │
│       ├─ ジョブ                                            │
│       └─ スキル配置[]                                      │
│      → 通常モードで編集可能                                │
│      → ローカルストレージに自動保存                        │
└─────────────────────────────────────────────────────────────┘
```

### 1.3 フォルダ構成

```
project/
├── index.html
├── src/
│   └── ...
└── data/
    ├── contents/                          # コンテンツデータ
    │   ├── アルカディア・ヘビー級零式/
    │   │   ├── 1層.json
    │   │   ├── 2層.json
    │   │   ├── 3層.json
    │   │   └── 4層.json
    │   └── アルカディア・クルーザー級零式/
    │       ├── 1層.json
    │       └── ...
    └── skills/                            # スキルマスターデータ
        └── jobs.json
```

---

## 2. データ保存方式

| 対象 | 保存場所 | 自動保存 | 手動保存 |
|------|---------|---------|---------|
| コンテンツ | サブフォルダ内JSON | なし | JSONダウンロード→手動配置 |
| パーティ構成 | ローカルストレージ | デバウンス（操作後2秒） | JSONダウンロード |
| スキルマスター | サブフォルダ内JSON | なし | 手動管理 |

### 読み込み
- コンテンツ: アプリ起動時にフォルダから読み込み
- パーティ: ローカルストレージ or JSONインポート

---

## 3. 画面設計

### 3.1 画面モード

| モード | 説明 | 編集可能な項目 |
|--------|------|---------------|
| 通常モード | パーティのスキル配置を行う | スキル配置、メンバー編集 |
| 編集モード | コンテンツ（ボス/ギミック）を作成・編集 | フェーズ、ギミック、タイムライン長 |

### 3.2 ヘッダーレイアウト

**通常モード:**
```
┌──────────────────────────────────────────────────────────────┐
│ [ボス選択 ▼] [パーティ選択 ▼] [パーティ管理] [設定] [保存]  │
└──────────────────────────────────────────────────────────────┘
```

**編集モード:**
```
┌──────────────────────────────────────────────────────────────┐
│ [編集中: ボス名]                         [編集終了] [保存]  │
└──────────────────────────────────────────────────────────────┘
```

### 3.3 ボス選択UI（カスケードメニュー）

```
[ボス選択 ▼]
├─ アルカディア・ヘビー級零式 ▶ ├─ 1層
│                              ├─ 1層（編集）
│                              ├─ 2層
│                              ├─ 2層（編集）
│                              └─ ...
├─ アルカディア・クルーザー級零式 ▶ ...
├─ ─────────────────────────
└─ ＋新規作成
```

### 3.4 メイン画面構成

```
┌─────────────────────────────────────────────────────────────┐
│  ヘッダー                                                   │
├─────────────────────────────────────────────────────────────┤
│  タイムライン                                               │
│  ┌────────┬──────────────────────────────────────────────┐ │
│  │ 行頭    │  横スクロール領域                            │ │
│  │(128px) │                                              │ │
│  ├────────┼──────────────────────────────────────────────┤ │
│  │フェーズ │  [フェーズバー...]                           │ │
│  ├────────┼──────────────────────────────────────────────┤ │
│  │時間    │  0:00  0:30  1:00  1:30  ...                 │ │
│  ├────────┼──────────────────────────────────────────────┤ │
│  │ギミック │  [ギミックバー...]                           │ │
│  ├────────┼──────────────────────────────────────────────┤ │
│  │Job1 ▼  │  [スキル...]                                 │ │
│  │名前入力 │                                              │ │
│  ├────────┼──────────────────────────────────────────────┤ │
│  │Job2 ▼  │  [スキル...]                                 │ │
│  │...     │                                              │ │
│  └────────┴──────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────────┤
│  ヘルプテキスト                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## 4. 操作仕様

### 4.1 メンバー編集（インライン）
- ジョブ: ドロップダウンで選択（常時表示）
- プレイヤー名: 入力欄として常時表示

### 4.2 スキル操作

| 操作 | 動作 |
|------|------|
| ジョブ行クリック | そのジョブのスキル一覧がポップアップ → 選択して配置 |
| スキルをドラッグ | 時刻を移動 |
| スキルをクリック | 選択状態 → その場にドロップダウン表示 → スキル変更可能 |
| スキルを右クリック | 削除メニュー表示 |

### 4.3 ギミック操作（編集モード時のみ）

| 操作 | 動作 |
|------|------|
| ギミック行クリック | その時刻にギミック追加 |
| ギミックをドラッグ | 時刻を移動 |
| ギミックをダブルクリック | 名前変更 |
| ギミックを右クリック | プロパティ編集メニュー |

### 4.4 フェーズ操作（編集モード時のみ）

| 操作 | 動作 |
|------|------|
| 追加ボタン | 新しいフェーズを追加（前フェーズ終了時刻から開始） |
| 右端ドラッグ | 終了時刻を調整 |
| 開閉ボタン | フェーズ内ギミックの表示/非表示 |

---

## 5. モーダル一覧

### 5.1 パーティ管理モーダル
- パーティ一覧表示
- 新規作成
- 保存（ローカルストレージ）
- JSONダウンロード
- JSONインポート

### 5.2 設定モーダル
- （未決定：タイムライン長、ターゲット管理、表示スケール等）

---

## 6. スキルデータ

### 6.1 方式
- **マスターデータ方式**
- ジョブごとのスキル一覧 + ロール共通スキル
- 公式サイト・攻略サイトから初期データを作成

### 6.2 ジョブ一覧

| ロール | ジョブ | 表示色 |
|--------|--------|--------|
| タンク | ナイト、戦士、ガンブレイカー、暗黒騎士 | 青 |
| ヒーラー | 白魔道士、学者、占星術師、賢者 | 緑 |
| DPS | モンク、竜騎士、忍者、侍、リーパー、ヴァイパー、吟遊詩人、機工士、踊り子、黒魔道士、召喚士、赤魔道士、ピクトマンサー | 赤 |

---

## 7. 未決定事項

- [ ] 設定モーダルの内容（タイムライン長、ターゲット管理、表示スケール等）
- [ ] スキルマスターデータの詳細構造
- [ ] コンテンツJSONの詳細構造
- [ ] パーティJSONの詳細構造
- [ ] エラーハンドリング方針
- [ ] スクロール挙動の詳細

---

## 8. 注意書き（ユーザー向け）

### コンテンツ新規作成時
```
⚠ 新規作成について
保存したJSONファイルは、以下の場所に手動で配置してください:
  data/contents/[レイド名]/[ボス名].json
配置後、ページを再読み込みすると反映されます。
新しいレイド（フォルダ）を追加する場合は、手動でフォルダを作成してください。
```
